name: REST CI
on: workflow_call

jobs:
  rest-ci:
    runs-on: ubuntu-latest

    steps:
      # Tested this locally with `act`. If this workflow fails on the remote repository, this CI job will also fail.
      - name: Workflow dispatch to TileDB-REST-CI
        id: trigger-step
        uses: aurelien-baudet/workflow-dispatch@v2
        with:
          repo: TileDB-Inc/TileDB-REST-CI
          workflow: Full CI
          # TODO: We could use a PAT or set repository deploy keys with public / private key pair.
          token: ${{ secrets.TILEDB_PAT }}
          inputs: '{ "tiledb_ref": "${{ github.ref_name }}"}'
          display-workflow-run-url-interval: 5s
          wait-for-completion-interval: 5s
